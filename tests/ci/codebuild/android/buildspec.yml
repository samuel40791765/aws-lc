version: 0.2

phases:
  build:
    commands:
      - chmod +x ./tests/ci/android/AWSLCAndroidTestRunner/gradlew
      - cd tests/ci/android/AWSLCAndroidTestRunner
      - mkdir apk-artifacts
      - ./gradlew assembleDebug assembleAndroidTest
      - mv app/build/outputs/apk apk-artifacts/non-fips-dbg
      - ./gradlew clean assembleDebug assembleAndroidTest -PRelease
      - mv app/build/outputs/apk apk-artifacts/non-fips-rel
      - ./gradlew clean assembleDebug assembleAndroidTest -PFIPS
      - mv app/build/outputs/apk apk-artifacts/fips
      - ls apk-artifacts
artifacts:
  files:
     - './AWSLCAndroidTestRunner/apk-artifacts/**/**/*.apk'
  discard-paths: yes

